{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n *\n * @param {*} data 当前数据是不是对象\n */\nexport function isObject(data) {\n  return typeof data === \"object\" && data !== null;\n}\n\n/**\n *\n * @param {*} data\n * @param {*} key\n * @param {*} value 定义不可枚举属性\n */\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    value,\n  });\n}\n","let oldArrayProtoMethods = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n];\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        const result = oldArrayProtoMethods[method].apply(this, args);\n        // AOP 切片编程\n        const ob = this.__ob__;// 拿到当前observe实例\n        let inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n            default:\n                break;\n        }\n        if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\n        return result\n    }\n})","import {isObject, def} from '../utils/index'\nimport {arrayMethods} from './array';\n\nfunction proxy(vm,source,key){\n  Object.defineProperty(vm,key,{\n      get(){\n          return vm[source][key];\n      },\n      set(newValue){\n          vm[source][key] = newValue;\n      }\n  });\n}\n\n\nclass Observer {\n  constructor(data) {\n    // 给每一个监控过的对象都添加一个__ob__属性\n    def(data, '__ob__', this)\n    for(let key in data){ // 将_data上的属性全部代理给vm实例\n      proxy(vm,'_data',key)\n    }\n    if(Array.isArray(data)) {\n      data.__proto__ = arrayMethods\n      this.observeArray(data)\n    }else {\n      this.walk(data)\n    }\n  }\n  observeArray(array) {\n    array.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data)\n    keys.forEach(key => {\n      value = data[key]\n      defineReactive(data, key, value)\n    })\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value)\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      if(newValue == value) return;\n      observe(newValue);\n      value = newValue\n    }\n  })\n}\nexport function observe(data) {\n  if(isObject(data)) {\n    return new Observer(data)\n  }\n}","import {observe} from './observer/index.js'\n\nexport function initState (vm) {\n  const opts = vm.$options\n  if(opts.data) {\n    initData(vm)\n  }\n}\n\nfunction initData(){\n  let data = this.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  observe(data)\n}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;  \nconst qnameCapture = `((?:${ncname}\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\n\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\n //    attr   =   \nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nlet root;\nlet currentParent;\nlet stack = [];\nconst ELEMENT_TYPE = 1;\nconst TEXT_TYPE = 3;\n\nfunction createASTElement(tagName,attrs){\n    return {\n        tag:tagName,\n        type:ELEMENT_TYPE,\n        children:[],\n        attrs,\n        parent:null\n    }\n}\nfunction start(tagName, attrs) {\n    console.log(`开始${tagName}标签，attrs是`);\n    console.log(attrs);\n    let element = createASTElement(tagName,attrs);\n    if(!root){\n        root = element;\n    }\n    currentParent = element;\n    stack.push(element);\n}\nfunction end(tagName) {\n    console.log(`结束${tagName}标签`);\n    let element = stack.pop();\n    currentParent = stack[stack.length-1];\n    if(currentParent){\n        element.parent = currentParent;\n        currentParent.children.push(element);\n    }\n}\nfunction chars(text) {\n    console.log(`文本是${text}`);\n    text = text.replace(/\\s/g,'');\n    if(text){\n        currentParent.children.push({\n            type:TEXT_TYPE,\n            text\n        })\n    }\n}\nfunction parseHTML(html){\n    while(html){\n        let textEnd = html.indexOf('<');\n        if(textEnd == 0){\n            const startTagMatch = parseStartTag();\n            if(startTagMatch){\n                start(startTagMatch.tagName,startTagMatch.attrs);\n                continue;\n            }\n            const endTagMatch = html.match(endTag);\n            if(endTagMatch){\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]);\n                continue;\n            }\n        }\n        let text;\n        if(textEnd >= 0){\n            text = html.substring(0,textEnd);\n        }\n        if(text){\n            advance(text.length);\n            chars(text);\n        }\n    }\n    // 前进n个\n    function advance(n){\n        html = html.substring(n);\n    }\n    function parseStartTag(){\n        const start = html.match(startTagOpen);\n        if(start){\n            const match = {\n                tagName:start[1],\n                attrs:[]\n            }\n            // 将标签删除\n            advance(start[0].length);\n            let attr,end;\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\n                advance(attr[0].length);// 将属性删除\n                match.attrs.push({name:attr[1],value:attr[3]||attr[4]||attr[5]});\n            }\n            if(end){ // 去掉开始标签的 >\n                advance(end[0].length);\n                return match\n            }\n        }\n    }\n}\n\n\nexport function compileToFunctions(template){\n  parseHTML(template);\n\n  function gen(node) {\n    if (node.type == 1) {\n        return generate(node);\n    } else {\n        let text = node.text\n        if(!defaultTagRE.test(text)){\n            return `_v(${JSON.stringify(text)})`\n        }\n        let lastIndex = defaultTagRE.lastIndex = 0\n        let tokens = [];\n        let match,index;\n        \n        while (match = defaultTagRE.exec(text)) {\n            index = match.index;\n            if(index > lastIndex){\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n            }\n            tokens.push(`_s(${match[1].trim()})`)\n            lastIndex = index + match[0].length;\n        }\n        if(lastIndex < text.length){\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n        return `_v(${tokens.join('+')})`;\n    }\n  }\n  function getChildren(el) { // 生成儿子节点\n      const children = el.children;\n      if (children) {\n        const res = `${children.map(c=>gen(c)).join(',')}`\n        return res\n      } else {\n        return false;\n      }\n  }\n  function genProps(attrs){ // 生成属性\n      let str = '';\n      for(let i = 0; i<attrs.length; i++){\n          let attr = attrs[i];\n          if(attr.name === 'style'){\n              let obj = {}\n              attr.value.split(';').forEach(item=>{\n                  let [key,value] = item.split(':');\n                  obj[key] = value;\n              })\n              attr.value = obj;\n          }\n          str += `${attr.name}:${JSON.stringify(attr.value)},`;\n      }\n      return `{${str.slice(0,-1)}}`;\n  }\n  function generate(el) {\n      let children = getChildren(el);\n      let code = `_c('${el.tag}',${\n          el.attrs.length?`${genProps(el.attrs)}`:'undefined'\n      }${\n          children? `,${children}`:''\n      })`;\n      return code;\n  }\n  let code = generate(root);\n  let render = `with(this){return ${code}}`;\n  let renderFn = new Function(render);\n  return renderFn\n\n}","import {initState} from './state'\nimport {compileToFunctions} from './compiler/index'\n\nexport function initMixin (Vue) {\n  Vue.prototype._init = function(options) {\n    const vm = this\n    this.$options = options\n    // 初始化状态\n    initState(vm);\n\n    // 页面挂载：如果用户\n    if (vm.$options.el) {\n    \tvm.$mount(vm.$options.el);\n    }\n  }\n  Vue.prototype.$mount = function(el) {\n    const vm = this\n    const options = this.$options\n    el = document.querySelector(el)\n\n    // 如果没有render方法,将template编译成render函数\n    if(!options.render) {\n      let template = options.template\n      if(!template && el) {\n        template = el.outerHTML\n      }\n      const render = compileToFunctions(template);\n      options.render = render;\n    }\n  }\n}","import {initMixin} from './init.js'\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArrayProtoMethods","Array","prototype","arrayMethods","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","proxy","vm","source","get","set","newValue","Observer","isArray","__proto__","walk","array","item","observe","keys","defineReactive","initState","opts","$options","initData","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","defaultTagRE","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","console","log","element","push","end","pop","length","chars","text","replace","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","compileToFunctions","template","gen","node","generate","test","JSON","stringify","lastIndex","tokens","index","exec","trim","join","getChildren","el","res","map","c","genProps","str","i","obj","split","code","render","renderFn","Function","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA;EACO,SAASA,QAAT,CAAkBC,IAAlB,EAAwB;EAC7B,SAAO,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAA5C;EACD;EAED;EACA;EACA;EACA;EACA;EACA;;EACO,SAASC,GAAT,CAAaD,IAAb,EAAmBE,GAAnB,EAAwBC,KAAxB,EAA+B;EACpCC,EAAAA,MAAM,CAACC,cAAP,CAAsBL,IAAtB,EAA4BE,GAA5B,EAAiC;EAC/BI,IAAAA,UAAU,EAAE,KADmB;EAE/BC,IAAAA,YAAY,EAAE,KAFiB;EAG/BJ,IAAAA,KAAK,EAALA;EAH+B,GAAjC;EAKD;;ECpBD,IAAIK,oBAAoB,GAAGC,KAAK,CAACC,SAAjC;EACO,IAAIC,YAAY,GAAGP,MAAM,CAACQ,MAAP,CAAcJ,oBAAd,CAAnB;EACP,IAAIK,OAAO,GAAG,CACV,MADU,EAEV,KAFU,EAGV,OAHU,EAIV,SAJU,EAKV,SALU,EAMV,MANU,EAOV,QAPU,CAAd;EASAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,MAAM,EAAI;EACtBJ,EAAAA,YAAY,CAACI,MAAD,CAAZ,GAAuB,YAAmB;EAAA,sCAANC,IAAM;EAANA,MAAAA,IAAM;EAAA;;EACtC,QAAMC,MAAM,GAAGT,oBAAoB,CAACO,MAAD,CAApB,CAA6BG,KAA7B,CAAmC,IAAnC,EAAyCF,IAAzC,CAAf,CADsC;;EAGtC,QAAMG,EAAE,GAAG,KAAKC,MAAhB,CAHsC;;EAItC,QAAIC,QAAJ;;EACA,YAAQN,MAAR;EACI,WAAK,MAAL;EACA,WAAK,SAAL;EACIM,QAAAA,QAAQ,GAAGL,IAAX;EACA;;EACJ,WAAK,QAAL;EACIK,QAAAA,QAAQ,GAAGL,IAAI,CAACM,KAAL,CAAW,CAAX,CAAX;EANR;;EAUA,QAAID,QAAJ,EAAcF,EAAE,CAACI,YAAH,CAAgBF,QAAhB,EAfwB;;EAgBtC,WAAOJ,MAAP;EACH,GAjBD;EAkBH,CAnBD;;ECRA,SAASO,KAAT,CAAeC,EAAf,EAAkBC,MAAlB,EAAyBxB,GAAzB,EAA6B;EAC3BE,EAAAA,MAAM,CAACC,cAAP,CAAsBoB,EAAtB,EAAyBvB,GAAzB,EAA6B;EACzByB,IAAAA,GADyB,iBACpB;EACD,aAAOF,EAAE,CAACC,MAAD,CAAF,CAAWxB,GAAX,CAAP;EACH,KAHwB;EAIzB0B,IAAAA,GAJyB,eAIrBC,QAJqB,EAIZ;EACTJ,MAAAA,EAAE,CAACC,MAAD,CAAF,CAAWxB,GAAX,IAAkB2B,QAAlB;EACH;EANwB,GAA7B;EAQD;;MAGKC;EACJ,oBAAY9B,IAAZ,EAAkB;EAAA;;EAChB;EACAC,IAAAA,GAAG,CAACD,IAAD,EAAO,QAAP,EAAiB,IAAjB,CAAH;;EACA,SAAI,IAAIE,GAAR,IAAeF,IAAf,EAAoB;EAAE;EACpBwB,MAAAA,KAAK,CAACC,EAAD,EAAI,OAAJ,EAAYvB,GAAZ,CAAL;EACD;;EACD,QAAGO,KAAK,CAACsB,OAAN,CAAc/B,IAAd,CAAH,EAAwB;EACtBA,MAAAA,IAAI,CAACgC,SAAL,GAAiBrB,YAAjB;EACA,WAAKY,YAAL,CAAkBvB,IAAlB;EACD,KAHD,MAGM;EACJ,WAAKiC,IAAL,CAAUjC,IAAV;EACD;EACF;;;;mCACYkC,OAAO;EAClBA,MAAAA,KAAK,CAACpB,OAAN,CAAc,UAAAqB,IAAI,EAAI;EACpBC,QAAAA,OAAO,CAACD,IAAD,CAAP;EACD,OAFD;EAGD;;;2BACInC,MAAM;EACT,UAAIqC,IAAI,GAAGjC,MAAM,CAACiC,IAAP,CAAYrC,IAAZ,CAAX;EACAqC,MAAAA,IAAI,CAACvB,OAAL,CAAa,UAAAZ,GAAG,EAAI;EAClBC,QAAAA,KAAK,GAAGH,IAAI,CAACE,GAAD,CAAZ;EACAoC,QAAAA,cAAc,CAACtC,IAAD,EAAOE,GAAP,EAAYC,KAAZ,CAAd;EACD,OAHD;EAID;;;;;;EAGH,SAASmC,cAAT,CAAwBtC,IAAxB,EAA8BE,GAA9B,EAAmCC,KAAnC,EAA0C;EACxCiC,EAAAA,OAAO,CAACjC,KAAD,CAAP;EACAC,EAAAA,MAAM,CAACC,cAAP,CAAsBL,IAAtB,EAA4BE,GAA5B,EAAiC;EAC/ByB,IAAAA,GAD+B,iBACzB;EACJ,aAAOxB,KAAP;EACD,KAH8B;EAI/ByB,IAAAA,GAJ+B,eAI3BC,QAJ2B,EAIjB;EACZ,UAAGA,QAAQ,IAAI1B,KAAf,EAAsB;EACtBiC,MAAAA,OAAO,CAACP,QAAD,CAAP;EACA1B,MAAAA,KAAK,GAAG0B,QAAR;EACD;EAR8B,GAAjC;EAUD;;EACM,SAASO,OAAT,CAAiBpC,IAAjB,EAAuB;EAC5B,MAAGD,QAAQ,CAACC,IAAD,CAAX,EAAmB;EACjB,WAAO,IAAI8B,QAAJ,CAAa9B,IAAb,CAAP;EACD;EACF;;EC1DM,SAASuC,SAAT,CAAoBd,EAApB,EAAwB;EAC7B,MAAMe,IAAI,GAAGf,EAAE,CAACgB,QAAhB;;EACA,MAAGD,IAAI,CAACxC,IAAR,EAAc;EACZ0C,IAAAA,QAAQ,CAAA,CAAR;EACD;EACF;;EAED,SAASA,QAAT,GAAmB;EACjB,MAAI1C,IAAI,GAAG,KAAKyC,QAAL,CAAczC,IAAzB;EACAA,EAAAA,IAAI,GAAGyB,EAAE,CAACkB,KAAH,GAAW,OAAO3C,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAAC4C,IAAL,CAAUnB,EAAV,CAA7B,GAA6CzB,IAA/D;EACAoC,EAAAA,OAAO,CAACpC,IAAD,CAAP;EACD;;ECbD,IAAM6C,MAAM,iCAAZ;EACA,IAAMC,YAAY,iBAAUD,MAAV,gBAAuBA,MAAvB,MAAlB;EACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,EAArB;;EAEA,IAAMG,MAAM,GAAG,IAAID,MAAJ,gBAAmBF,YAAnB,YAAf;EACC;;EACD,IAAMI,SAAS,GAAG,2EAAlB;;EACA,IAAMC,aAAa,GAAG,YAAtB;;EACA,IAAMC,YAAY,GAAG,0BAArB;EACA,IAAIC,IAAJ;EACA,IAAIC,aAAJ;EACA,IAAIC,KAAK,GAAG,EAAZ;EACA,IAAMC,YAAY,GAAG,CAArB;EACA,IAAMC,SAAS,GAAG,CAAlB;;EAEA,SAASC,gBAAT,CAA0BC,OAA1B,EAAkCC,KAAlC,EAAwC;EACpC,SAAO;EACHC,IAAAA,GAAG,EAACF,OADD;EAEHG,IAAAA,IAAI,EAACN,YAFF;EAGHO,IAAAA,QAAQ,EAAC,EAHN;EAIHH,IAAAA,KAAK,EAALA,KAJG;EAKHI,IAAAA,MAAM,EAAC;EALJ,GAAP;EAOH;;EACD,SAASC,KAAT,CAAeN,OAAf,EAAwBC,KAAxB,EAA+B;EAC3BM,EAAAA,OAAO,CAACC,GAAR,uBAAiBR,OAAjB;EACAO,EAAAA,OAAO,CAACC,GAAR,CAAYP,KAAZ;EACA,MAAIQ,OAAO,GAAGV,gBAAgB,CAACC,OAAD,EAASC,KAAT,CAA9B;;EACA,MAAG,CAACP,IAAJ,EAAS;EACLA,IAAAA,IAAI,GAAGe,OAAP;EACH;;EACDd,EAAAA,aAAa,GAAGc,OAAhB;EACAb,EAAAA,KAAK,CAACc,IAAN,CAAWD,OAAX;EACH;;EACD,SAASE,GAAT,CAAaX,OAAb,EAAsB;EAClBO,EAAAA,OAAO,CAACC,GAAR,uBAAiBR,OAAjB;EACA,MAAIS,OAAO,GAAGb,KAAK,CAACgB,GAAN,EAAd;EACAjB,EAAAA,aAAa,GAAGC,KAAK,CAACA,KAAK,CAACiB,MAAN,GAAa,CAAd,CAArB;;EACA,MAAGlB,aAAH,EAAiB;EACbc,IAAAA,OAAO,CAACJ,MAAR,GAAiBV,aAAjB;EACAA,IAAAA,aAAa,CAACS,QAAd,CAAuBM,IAAvB,CAA4BD,OAA5B;EACH;EACJ;;EACD,SAASK,KAAT,CAAeC,IAAf,EAAqB;EACjBR,EAAAA,OAAO,CAACC,GAAR,6BAAkBO,IAAlB;EACAA,EAAAA,IAAI,GAAGA,IAAI,CAACC,OAAL,CAAa,KAAb,EAAmB,EAAnB,CAAP;;EACA,MAAGD,IAAH,EAAQ;EACJpB,IAAAA,aAAa,CAACS,QAAd,CAAuBM,IAAvB,CAA4B;EACxBP,MAAAA,IAAI,EAACL,SADmB;EAExBiB,MAAAA,IAAI,EAAJA;EAFwB,KAA5B;EAIH;EACJ;;EACD,SAASE,SAAT,CAAmBC,IAAnB,EAAwB;EACpB,SAAMA,IAAN,EAAW;EACP,QAAIC,OAAO,GAAGD,IAAI,CAACE,OAAL,CAAa,GAAb,CAAd;;EACA,QAAGD,OAAO,IAAI,CAAd,EAAgB;EACZ,UAAME,aAAa,GAAGC,aAAa,EAAnC;;EACA,UAAGD,aAAH,EAAiB;EACbf,QAAAA,KAAK,CAACe,aAAa,CAACrB,OAAf,EAAuBqB,aAAa,CAACpB,KAArC,CAAL;EACA;EACH;;EACD,UAAMsB,WAAW,GAAGL,IAAI,CAACM,KAAL,CAAWlC,MAAX,CAApB;;EACA,UAAGiC,WAAH,EAAe;EACXE,QAAAA,OAAO,CAACF,WAAW,CAAC,CAAD,CAAX,CAAeV,MAAhB,CAAP;EACAF,QAAAA,GAAG,CAACY,WAAW,CAAC,CAAD,CAAZ,CAAH;EACA;EACH;EACJ;;EACD,QAAIR,IAAI,SAAR;;EACA,QAAGI,OAAO,IAAI,CAAd,EAAgB;EACZJ,MAAAA,IAAI,GAAGG,IAAI,CAACQ,SAAL,CAAe,CAAf,EAAiBP,OAAjB,CAAP;EACH;;EACD,QAAGJ,IAAH,EAAQ;EACJU,MAAAA,OAAO,CAACV,IAAI,CAACF,MAAN,CAAP;EACAC,MAAAA,KAAK,CAACC,IAAD,CAAL;EACH;EACJ,GAxBmB;;;EA0BpB,WAASU,OAAT,CAAiBE,CAAjB,EAAmB;EACfT,IAAAA,IAAI,GAAGA,IAAI,CAACQ,SAAL,CAAeC,CAAf,CAAP;EACH;;EACD,WAASL,aAAT,GAAwB;EACpB,QAAMhB,KAAK,GAAGY,IAAI,CAACM,KAAL,CAAWpC,YAAX,CAAd;;EACA,QAAGkB,KAAH,EAAS;EACL,UAAMkB,KAAK,GAAG;EACVxB,QAAAA,OAAO,EAACM,KAAK,CAAC,CAAD,CADH;EAEVL,QAAAA,KAAK,EAAC;EAFI,OAAd,CADK;;EAMLwB,MAAAA,OAAO,CAACnB,KAAK,CAAC,CAAD,CAAL,CAASO,MAAV,CAAP;;EACA,UAAIe,IAAJ,EAASjB,IAAT;;EACA,aAAM,EAAEA,IAAG,GAAGO,IAAI,CAACM,KAAL,CAAWhC,aAAX,CAAR,MAAuCoC,IAAI,GAAGV,IAAI,CAACM,KAAL,CAAWjC,SAAX,CAA9C,CAAN,EAA2E;EACvEkC,QAAAA,OAAO,CAACG,IAAI,CAAC,CAAD,CAAJ,CAAQf,MAAT,CAAP,CADuE;;EAEvEW,QAAAA,KAAK,CAACvB,KAAN,CAAYS,IAAZ,CAAiB;EAACmB,UAAAA,IAAI,EAACD,IAAI,CAAC,CAAD,CAAV;EAAcpF,UAAAA,KAAK,EAACoF,IAAI,CAAC,CAAD,CAAJ,IAASA,IAAI,CAAC,CAAD,CAAb,IAAkBA,IAAI,CAAC,CAAD;EAA1C,SAAjB;EACH;;EACD,UAAGjB,IAAH,EAAO;EAAE;EACLc,QAAAA,OAAO,CAACd,IAAG,CAAC,CAAD,CAAH,CAAOE,MAAR,CAAP;EACA,eAAOW,KAAP;EACH;EACJ;EACJ;EACJ;;EAGM,SAASM,kBAAT,CAA4BC,QAA5B,EAAqC;EAC1Cd,EAAAA,SAAS,CAACc,QAAD,CAAT;;EAEA,WAASC,GAAT,CAAaC,IAAb,EAAmB;EACjB,QAAIA,IAAI,CAAC9B,IAAL,IAAa,CAAjB,EAAoB;EAChB,aAAO+B,QAAQ,CAACD,IAAD,CAAf;EACH,KAFD,MAEO;EACH,UAAIlB,IAAI,GAAGkB,IAAI,CAAClB,IAAhB;;EACA,UAAG,CAACtB,YAAY,CAAC0C,IAAb,CAAkBpB,IAAlB,CAAJ,EAA4B;EACxB,4BAAaqB,IAAI,CAACC,SAAL,CAAetB,IAAf,CAAb;EACH;;EACD,UAAIuB,SAAS,GAAG7C,YAAY,CAAC6C,SAAb,GAAyB,CAAzC;EACA,UAAIC,MAAM,GAAG,EAAb;EACA,UAAIf,KAAJ,EAAUgB,KAAV;;EAEA,aAAOhB,KAAK,GAAG/B,YAAY,CAACgD,IAAb,CAAkB1B,IAAlB,CAAf,EAAwC;EACpCyB,QAAAA,KAAK,GAAGhB,KAAK,CAACgB,KAAd;;EACA,YAAGA,KAAK,GAAGF,SAAX,EAAqB;EACjBC,UAAAA,MAAM,CAAC7B,IAAP,CAAY0B,IAAI,CAACC,SAAL,CAAetB,IAAI,CAACpD,KAAL,CAAW2E,SAAX,EAAqBE,KAArB,CAAf,CAAZ;EACH;;EACDD,QAAAA,MAAM,CAAC7B,IAAP,cAAkBc,KAAK,CAAC,CAAD,CAAL,CAASkB,IAAT,EAAlB;EACAJ,QAAAA,SAAS,GAAGE,KAAK,GAAGhB,KAAK,CAAC,CAAD,CAAL,CAASX,MAA7B;EACH;;EACD,UAAGyB,SAAS,GAAGvB,IAAI,CAACF,MAApB,EAA2B;EACvB0B,QAAAA,MAAM,CAAC7B,IAAP,CAAY0B,IAAI,CAACC,SAAL,CAAetB,IAAI,CAACpD,KAAL,CAAW2E,SAAX,CAAf,CAAZ;EACH;;EACD,0BAAaC,MAAM,CAACI,IAAP,CAAY,GAAZ,CAAb;EACH;EACF;;EACD,WAASC,WAAT,CAAqBC,EAArB,EAAyB;EAAE;EACvB,QAAMzC,QAAQ,GAAGyC,EAAE,CAACzC,QAApB;;EACA,QAAIA,QAAJ,EAAc;EACZ,UAAM0C,GAAG,aAAM1C,QAAQ,CAAC2C,GAAT,CAAa,UAAAC,CAAC;EAAA,eAAEhB,GAAG,CAACgB,CAAD,CAAL;EAAA,OAAd,EAAwBL,IAAxB,CAA6B,GAA7B,CAAN,CAAT;EACA,aAAOG,GAAP;EACD,KAHD,MAGO;EACL,aAAO,KAAP;EACD;EACJ;;EACD,WAASG,QAAT,CAAkBhD,KAAlB,EAAwB;EAAE;EACtB,QAAIiD,GAAG,GAAG,EAAV;;EACA,SAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAClD,KAAK,CAACY,MAAvB,EAA+BsC,CAAC,EAAhC,EAAmC;EAC/B,UAAIvB,IAAI,GAAG3B,KAAK,CAACkD,CAAD,CAAhB;;EACA,UAAGvB,IAAI,CAACC,IAAL,KAAc,OAAjB,EAAyB;EAAA;EACrB,cAAIuB,GAAG,GAAG,EAAV;EACAxB,UAAAA,IAAI,CAACpF,KAAL,CAAW6G,KAAX,CAAiB,GAAjB,EAAsBlG,OAAtB,CAA8B,UAAAqB,IAAI,EAAE;EAAA,8BACdA,IAAI,CAAC6E,KAAL,CAAW,GAAX,CADc;EAAA;EAAA,gBAC3B9G,GAD2B;EAAA,gBACvBC,KADuB;;EAEhC4G,YAAAA,GAAG,CAAC7G,GAAD,CAAH,GAAWC,KAAX;EACH,WAHD;EAIAoF,UAAAA,IAAI,CAACpF,KAAL,GAAa4G,GAAb;EANqB;EAOxB;;EACDF,MAAAA,GAAG,cAAOtB,IAAI,CAACC,IAAZ,cAAoBO,IAAI,CAACC,SAAL,CAAeT,IAAI,CAACpF,KAApB,CAApB,MAAH;EACH;;EACD,sBAAW0G,GAAG,CAACvF,KAAJ,CAAU,CAAV,EAAY,CAAC,CAAb,CAAX;EACH;;EACD,WAASuE,QAAT,CAAkBW,EAAlB,EAAsB;EAClB,QAAIzC,QAAQ,GAAGwC,WAAW,CAACC,EAAD,CAA1B;EACA,QAAIS,IAAI,iBAAUT,EAAE,CAAC3C,GAAb,eACJ2C,EAAE,CAAC5C,KAAH,CAASY,MAAT,aAAmBoC,QAAQ,CAACJ,EAAE,CAAC5C,KAAJ,CAA3B,IAAwC,WADpC,SAGJG,QAAQ,cAAMA,QAAN,IAAiB,EAHrB,MAAR;EAKA,WAAOkD,IAAP;EACH;;EACD,MAAIA,IAAI,GAAGpB,QAAQ,CAACxC,IAAD,CAAnB;EACA,MAAI6D,MAAM,+BAAwBD,IAAxB,MAAV;EACA,MAAIE,QAAQ,GAAG,IAAIC,QAAJ,CAAaF,MAAb,CAAf;EACA,SAAOC,QAAP;EAED;;EC1KM,SAASE,SAAT,CAAoBC,GAApB,EAAyB;EAC9BA,EAAAA,GAAG,CAAC5G,SAAJ,CAAc6G,KAAd,GAAsB,UAASC,OAAT,EAAkB;EACtC,QAAM/F,EAAE,GAAG,IAAX;EACA,SAAKgB,QAAL,GAAgB+E,OAAhB,CAFsC;;EAItCjF,IAAAA,SAAS,CAACd,EAAD,CAAT,CAJsC;;EAOtC,QAAIA,EAAE,CAACgB,QAAH,CAAY+D,EAAhB,EAAoB;EACnB/E,MAAAA,EAAE,CAACgG,MAAH,CAAUhG,EAAE,CAACgB,QAAH,CAAY+D,EAAtB;EACA;EACF,GAVD;;EAWAc,EAAAA,GAAG,CAAC5G,SAAJ,CAAc+G,MAAd,GAAuB,UAASjB,EAAT,EAAa;EAElC,QAAMgB,OAAO,GAAG,KAAK/E,QAArB;EACA+D,IAAAA,EAAE,GAAGkB,QAAQ,CAACC,aAAT,CAAuBnB,EAAvB,CAAL,CAHkC;;EAMlC,QAAG,CAACgB,OAAO,CAACN,MAAZ,EAAoB;EAClB,UAAIxB,QAAQ,GAAG8B,OAAO,CAAC9B,QAAvB;;EACA,UAAG,CAACA,QAAD,IAAac,EAAhB,EAAoB;EAClBd,QAAAA,QAAQ,GAAGc,EAAE,CAACoB,SAAd;EACD;;EACD,UAAMV,MAAM,GAAGzB,kBAAkB,CAACC,QAAD,CAAjC;EACA8B,MAAAA,OAAO,CAACN,MAAR,GAAiBA,MAAjB;EACD;EACF,GAdD;EAeD;;EC7BD,SAASI,GAAT,CAAcE,OAAd,EAAuB;EACrB,OAAKD,KAAL,CAAWC,OAAX;EACD;;EACDH,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}