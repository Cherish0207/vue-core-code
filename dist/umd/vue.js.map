{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/parser-html.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["/**\n *\n * @param {*} data 当前数据是不是对象\n */\nexport function isObject(data) {\n  return typeof data === \"object\" && data !== null;\n}\n\n/**\n *\n * @param {*} data\n * @param {*} key\n * @param {*} value 定义不可枚举属性\n */\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    value,\n  });\n}\n/**\n * \n * @param {*} vm \n * @param {*} source \n * @param {*} key \n */\nexport function proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key];\n    },\n    set(newValue) {\n      vm[source][key] = newValue;\n    },\n  });\n}","let oldArrayProtoMethods = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\nlet methods = [\"push\", \"pop\", \"shift\", \"unshift\", \"reverse\", \"sort\", \"splice\"];\nmethods.forEach((method) => {\n  arrayMethods[method] = function (...args) {\n    const result = oldArrayProtoMethods[method].apply(this, args);\n    // AOP 切片编程\n    const ob = this.__ob__; // 拿到当前observe实例\n    let inserted;\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        inserted = args;\n        break;\n      case \"splice\":\n        inserted = args.slice(2);\n      default:\n        break;\n    }\n    if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\n    return result;\n  };\n});\n","import { isObject, def } from \"../utils/index\";\nimport { arrayMethods } from \"./array\";\n\nclass Observer {\n  constructor(data) {\n    // 给每一个监控过的对象都添加一个__ob__属性\n    def(data, \"__ob__\", this);\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods;\n      this.observeArray(data);\n    } else {\n      this.walk(data);\n    }\n  }\n  observeArray(array) {\n    array.forEach((item) => {\n      observe(item);\n    });\n  }\n  walk(data) {\n    let keys = Object.keys(data);\n    keys.forEach((key) => {\n      defineReactive(data, key, data[key]);\n    });\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value);\n  Object.defineProperty(data, key, {\n    get() {\n      return value;\n    },\n    set(newValue) {\n      if (newValue == value) return;\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\nexport function observe(data) {\n  if (isObject(data)) {\n    return new Observer(data);\n  }\n}\n","import { observe } from \"./observer/index.js\";\nimport { proxy } from \"./utils/index\";\n\nexport function initState(vm) {\n  const opts = vm.$options;\n  if (opts.data) {\n    initData(vm);\n  }\n}\nfunction initData(vm) {\n  let data = vm.$options.data;\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\n  for (let key in data) {\n    // 将_data上的属性全部代理给vm实例\n    proxy(vm, \"_data\", key);\n  }\n  observe(data);\n}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\n\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\nlet root;\nlet currentParent;\nlet stack = [];\nconst ELEMENT_TYPE = 1;\nconst TEXT_TYPE = 3;\n\nfunction createASTElement(tagName, attrs) {\n  return {\n    tag: tagName,\n    type: ELEMENT_TYPE,\n    children: [],\n    attrs,\n    parent: null,\n  };\n}\nfunction start(tagName, attrs) {\n  console.log(`开始${tagName}标签，attrs是`);\n  console.log(attrs);\n  let element = createASTElement(tagName, attrs);\n  if (!root) {\n    root = element;\n  }\n  currentParent = element;\n  stack.push(element);\n}\nfunction end(tagName) {\n  console.log(`结束${tagName}标签`);\n  let element = stack.pop();\n  currentParent = stack[stack.length - 1];\n  if (currentParent) {\n    element.parent = currentParent;\n    currentParent.children.push(element);\n  }\n}\nfunction chars(text) {\n  console.log(`文本是${text}`);\n  text = text.replace(/\\s/g, \"\");\n  if (text) {\n    currentParent.children.push({\n      type: TEXT_TYPE,\n      text,\n    });\n  }\n}\nexport default function parseHTML(html) {\n  while (html) {\n    let textEnd = html.indexOf(\"<\");\n    if (textEnd == 0) {\n      const startTagMatch = parseStartTag();\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n      const endTagMatch = html.match(endTag);\n      if (endTagMatch) {\n        advance(endTagMatch[0].length);\n        end(endTagMatch[1]);\n        continue;\n      }\n    }\n    let text;\n    if (textEnd >= 0) {\n      text = html.substring(0, textEnd);\n    }\n    if (text) {\n      advance(text.length);\n      chars(text);\n    }\n  }\n  // 前进n个\n  function advance(n) {\n    html = html.substring(n);\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      // 将标签删除\n      advance(start[0].length);\n      let attr, end;\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        advance(attr[0].length); // 将属性删除\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5],\n        });\n      }\n      if (end) {\n        // 去掉开始标签的 >\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n  return root\n}","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g; \n\nexport default function generate(el) {\n  let children = getChildren(el);\n  let code = `_c('${el.tag}',${\n    el.attrs.length ? `${genProps(el.attrs)}` : \"undefined\"\n  }${children ? `,${children}` : \"\"})`;\n  return code;\n}\nfunction getChildren(el) {\n  // 生成儿子节点\n  const children = el.children;\n  if (children) {\n    const res = `${children.map((c) => gen(c)).join(\",\")}`;\n    return res;\n  } else {\n    return false;\n  }\n}\n\nfunction genProps(attrs) {\n  // 生成属性\n  let str = \"\";\n  for (let i = 0; i < attrs.length; i++) {\n    let attr = attrs[i];\n    if (attr.name === \"style\") {\n      let obj = {};\n      attr.value.split(\";\").forEach((item) => {\n        let [key, value] = item.split(\":\");\n        obj[key] = value;\n      });\n      attr.value = obj;\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0, -1)}}`;\n}\n\nfunction gen(node) {\n  if (node.type == 1) {\n    return generate(node);\n  } else {\n    let text = node.text;\n    if (!defaultTagRE.test(text)) {\n      return `_v(${JSON.stringify(text)})`;\n    }\n    let lastIndex = (defaultTagRE.lastIndex = 0);\n    let tokens = [];\n    let match, index;\n\n    while ((match = defaultTagRE.exec(text))) {\n      index = match.index;\n      if (index > lastIndex) {\n        tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n      }\n      tokens.push(`_s(${match[1].trim()})`);\n      lastIndex = index + match[0].length;\n    }\n    if (lastIndex < text.length) {\n      tokens.push(JSON.stringify(text.slice(lastIndex)));\n    }\n    return `_v(${tokens.join(\"+\")})`;\n  }\n}\n","import parseHTML from './parser-html'\nimport generate from './generate'\n\nexport function compileToFunctions(template, vm) {\n  let root = parseHTML(template);\n  let code = generate(root, vm);\n  let render = `with(this){return ${code}}`;\n  let renderFn = new Function(render);\n  return renderFn;\n}\n","import { initState } from \"./state\";\nimport { compileToFunctions } from \"./compiler/index\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    this.$options = options;\n    // 初始化状态\n    initState(vm);\n\n    // 页面挂载\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el);\n    }\n  };\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const options = this.$options;\n    el = document.querySelector(el);\n\n    // 如果没有render方法,将template编译成render函数\n    if (!options.render) {\n      let template = options.template;\n      if (!template && el) {\n        template = el.outerHTML;\n      }\n      const render = compileToFunctions(template);\n      options.render = render;\n    }\n  };\n}\n","import { initMixin } from \"./init.js\";\nfunction Vue(options) {\n  this._init(options);\n}\ninitMixin(Vue);\nexport default Vue;\n"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","proxy","vm","source","get","set","newValue","oldArrayProtoMethods","Array","prototype","arrayMethods","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","Observer","isArray","__proto__","walk","array","item","observe","keys","defineReactive","initState","opts","$options","initData","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","console","log","element","push","end","pop","length","chars","text","replace","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","generate","el","getChildren","code","genProps","res","map","c","gen","join","str","i","obj","split","JSON","stringify","node","test","lastIndex","tokens","index","exec","trim","compileToFunctions","template","render","renderFn","Function","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML"],"mappings":"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"}