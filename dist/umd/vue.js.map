{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/template/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n];\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        const result = oldArrayProtoMethods[method].apply(this, args);\n        const ob = this.__ob__;\n        let inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n            default:\n                break;\n        }\n        if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\n        return result\n    }\n})","import {arrayMethods} from './array';\n\nfunction proxy(vm,source,key){\n  Object.defineProperty(vm,key,{\n      get(){\n          return vm[source][key];\n      },\n      set(newValue){\n          vm[source][key] = newValue;\n      }\n  });\n}\n\nclass Observer {\n  constructor(data) {\n    Object.defineProperty(value,'__ob__',{\n      enumerable:false,\n      configurable:false,\n      value:this\n    });\n    for(let key in data){ // 将_data上的属性全部代理给vm实例\n      proxy(vm,'_data',key)\n    }\n    if(Array.isArray(data)) {\n      value.__proto__ = arrayMethods\n      this.observeArray(data)\n    }else {\n      this.walk(data)\n    }\n  }\n  observeArray(array) {\n    array.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data)\n    keys.forEach(key => {\n      value = data[key]\n      defineReactive(data, key, value)\n    })\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value)\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      if(newValue == value) return;\n      observe(newValue);\n      value = newValue\n    }\n  })\n}\nexport function observe(data) {\n  if(typeof data === 'object' && data !== null) {\n    return new Observer(data)\n  }\n}","import {observe} from './observer/index.js'\n\nexport function initState (vm) {\n  const opts = vm.$options\n  if(opts.data) {\n    initData(vm)\n  }\n  // if(opts.props) {\n  //   initProps(vm)\n  // }\n  // if(opts.methods) {\n  //   initMethod(vm)\n  // }\n  // if(opts.computed) {\n  //   initComputed(vm)\n  // }\n  // if(opts.watch) {\n  //   initWatch(vm)\n  // }\n}\n\nfunction initData(){\n  let data = this.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  observe(data)\n}\n// function initProps(){}\n// function initMethod(){}\n// function initComputed(){}\n// function initWatch(){}","const ncname = `[a-zA-Z_][\\\\-\\.0-9_a-zA-Z]*`;  \nconst qnameCapture = `((?:${ncname}\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\n\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nlet root;\nlet currentParent;\nlet stack = [];\nconst ELEMENT_TYPE = 1;\nconst TEXT_TYPE = 3;\n\nfunction createASTElement(tagName,attrs){\n    return {\n        tag:tagName,\n        type:ELEMENT_TYPE,\n        children:[],\n        attrs,\n        parent:null\n    }\n}\nfunction start(tagName, attrs) {\n    let element = createASTElement(tagName,attrs);\n    if(!root){\n        root = element;\n    }\n    currentParent = element;\n    stack.push(element);\n}\nfunction end(tagName) {\n    let element = stack.pop();\n    currentParent = stack[stack.length-1];\n    if(currentParent){\n        element.parent = currentParent;\n        currentParent.children.push(element);\n    }\n}\nfunction chars(text) {\n    text = text.replace(/\\s/g,'');\n    if(text){\n        currentParent.children.push({\n            type:TEXT_TYPE,\n            text\n        })\n    }\n}\nfunction parseHTML(html){\n    while(html){\n        let textEnd = html.indexOf('<');\n        if(textEnd == 0){\n            const startTagMatch = parseStartTag();\n            if(startTagMatch){\n                start(startTagMatch.tagName,startTagMatch.attrs);\n                continue;\n            }\n            const endTagMatch = html.match(endTag);\n            if(endTagMatch){\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]);\n                continue;\n            }\n        }\n        let text;\n        if(textEnd >= 0){\n            text = html.substring(0,textEnd);\n        }\n        if(text){\n            advance(text.length);\n            chars(text);\n        }\n    }\n    function advance(n){\n        html = html.substring(n);\n    }\n    function parseStartTag(){\n        const start = html.match(startTagOpen);\n        if(start){\n            const match = {\n                tagName:start[1],\n                attrs:[]\n            }\n            advance(start[0].length);\n            let attr,end;\n            while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\n                advance(attr[0].length);\n                match.attrs.push({name:attr[1],value:attr[3]});\n            }\n            if(end){\n                advance(end[0].length);\n                return match\n            }\n        }\n    }\n}\n\n\nexport function compileToFunctions(template){\n  parseHTML(template);\n\n  function gen(node) {\n    if (node.type == 1) {\n        return generate(node);\n    } else {\n        let text = node.text\n        if(!defaultTagRE.test(text)){\n            return `_v(${JSON.stringify(text)})`\n        }\n        let lastIndex = defaultTagRE.lastIndex = 0\n        let tokens = [];\n        let match,index;\n        \n        while (match = defaultTagRE.exec(text)) {\n            index = match.index;\n            if(index > lastIndex){\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n            }\n            tokens.push(`_s(${match[1].trim()})`)\n            lastIndex = index + match[0].length;\n        }\n        if(lastIndex < text.length){\n            tokens.push(JSON.stringify(text.slice(lastIndex)))\n        }\n        return `_v(${tokens.join('+')})`;\n    }\n  }\n  function getChildren(el) { // 生成儿子节点\n      const children = el.children;\n      if (children) {\n        const res = `${children.map(c=>gen(c)).join(',')}`\n        return res\n      } else {\n        return false;\n      }\n  }\n  function genProps(attrs){ // 生成属性\n      let str = '';\n      for(let i = 0; i<attrs.length; i++){\n          let attr = attrs[i];\n          if(attr.name === 'style'){\n              let obj = {}\n              attr.value.split(';').forEach(item=>{\n                  let [key,value] = item.split(':');\n                  obj[key] = value;\n              })\n              attr.value = obj;\n          }\n          str += `${attr.name}:${JSON.stringify(attr.value)},`;\n      }\n      return `{${str.slice(0,-1)}}`;\n  }\n  function generate(el) {\n      let children = getChildren(el);\n      let code = `_c('${el.tag}',${\n          el.attrs.length?`${genProps(el.attrs)}`:'undefined'\n      }${\n          children? `,${children}`:''\n      })`;\n      return code;\n  }\n  let code = generate(root);\n  let render = `with(this){return ${code}}`;\n  let renderFn = new Function(render);\n  return renderFn\n\n}","import {initState} from './state'\nimport {compileToFunctions} from './template/index'\n\nexport function initMixin (Vue) {\n  Vue.prototype._init = function(options) {\n    const vm = this\n    this.$options = options\n    // 初始化状态\n    initState(vm);\n\n    // 页面挂载\n    if (vm.$options.el) {\n    \tvm.$mount(vm.$options.el);\n    }\n  }\n  Vue.prototype.$mount = function(el) {\n    const vm = this\n    const options = this.$options\n    el = document.querySelector(el)\n\n    // 如果没有render方法,将template编译成render函数\n    if(!options.render) {\n      let template = options.template\n      if(!template && el) {\n        template = el.outerHTML\n      }\n      const render = compileToFunctions(template);\n      options.render = render;\n    }\n  }\n}","import {initMixin} from './init.js'\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","proxy","vm","source","key","defineProperty","get","set","newValue","Observer","data","value","enumerable","configurable","isArray","__proto__","walk","array","item","observe","keys","defineReactive","initState","opts","$options","initData","_data","call","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","defaultTagRE","root","currentParent","stack","ELEMENT_TYPE","TEXT_TYPE","createASTElement","tagName","attrs","tag","type","children","parent","start","element","push","end","pop","length","chars","text","replace","parseHTML","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","compileToFunctions","template","gen","node","generate","test","JSON","stringify","lastIndex","tokens","index","exec","trim","join","getChildren","el","res","map","c","genProps","str","i","obj","split","code","render","renderFn","Function","initMixin","Vue","_init","options","$mount","document","querySelector","outerHTML"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA,IAAIA,oBAAoB,GAAGC,KAAK,CAACC,SAAjC;EACO,IAAIC,YAAY,GAAGC,MAAM,CAACC,MAAP,CAAcL,oBAAd,CAAnB;EACP,IAAIM,OAAO,GAAG,CACV,MADU,EAEV,KAFU,EAGV,OAHU,EAIV,SAJU,EAKV,SALU,EAMV,MANU,EAOV,QAPU,CAAd;EASAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,MAAM,EAAI;EACtBL,EAAAA,YAAY,CAACK,MAAD,CAAZ,GAAuB,YAAmB;EAAA,sCAANC,IAAM;EAANA,MAAAA,IAAM;EAAA;;EACtC,QAAMC,MAAM,GAAGV,oBAAoB,CAACQ,MAAD,CAApB,CAA6BG,KAA7B,CAAmC,IAAnC,EAAyCF,IAAzC,CAAf;EACA,QAAMG,EAAE,GAAG,KAAKC,MAAhB;EACA,QAAIC,QAAJ;;EACA,YAAQN,MAAR;EACI,WAAK,MAAL;EACA,WAAK,SAAL;EACIM,QAAAA,QAAQ,GAAGL,IAAX;EACA;;EACJ,WAAK,QAAL;EACIK,QAAAA,QAAQ,GAAGL,IAAI,CAACM,KAAL,CAAW,CAAX,CAAX;EANR;;EAUA,QAAID,QAAJ,EAAcF,EAAE,CAACI,YAAH,CAAgBF,QAAhB,EAdwB;;EAetC,WAAOJ,MAAP;EACH,GAhBD;EAiBH,CAlBD;;ECTA,SAASO,KAAT,CAAeC,EAAf,EAAkBC,MAAlB,EAAyBC,GAAzB,EAA6B;EAC3BhB,EAAAA,MAAM,CAACiB,cAAP,CAAsBH,EAAtB,EAAyBE,GAAzB,EAA6B;EACzBE,IAAAA,GADyB,iBACpB;EACD,aAAOJ,EAAE,CAACC,MAAD,CAAF,CAAWC,GAAX,CAAP;EACH,KAHwB;EAIzBG,IAAAA,GAJyB,eAIrBC,QAJqB,EAIZ;EACTN,MAAAA,EAAE,CAACC,MAAD,CAAF,CAAWC,GAAX,IAAkBI,QAAlB;EACH;EANwB,GAA7B;EAQD;;MAEKC;EACJ,oBAAYC,IAAZ,EAAkB;EAAA;;EAChBtB,IAAAA,MAAM,CAACiB,cAAP,CAAsBM,KAAtB,EAA4B,QAA5B,EAAqC;EACnCC,MAAAA,UAAU,EAAC,KADwB;EAEnCC,MAAAA,YAAY,EAAC,KAFsB;EAGnCF,MAAAA,KAAK,EAAC;EAH6B,KAArC;;EAKA,SAAI,IAAIP,GAAR,IAAeM,IAAf,EAAoB;EAAE;EACpBT,MAAAA,KAAK,CAACC,EAAD,EAAI,OAAJ,EAAYE,GAAZ,CAAL;EACD;;EACD,QAAGnB,KAAK,CAAC6B,OAAN,CAAcJ,IAAd,CAAH,EAAwB;EACtBC,MAAAA,KAAK,CAACI,SAAN,GAAkB5B,YAAlB;EACA,WAAKa,YAAL,CAAkBU,IAAlB;EACD,KAHD,MAGM;EACJ,WAAKM,IAAL,CAAUN,IAAV;EACD;EACF;;;;mCACYO,OAAO;EAClBA,MAAAA,KAAK,CAAC1B,OAAN,CAAc,UAAA2B,IAAI,EAAI;EACpBC,QAAAA,OAAO,CAACD,IAAD,CAAP;EACD,OAFD;EAGD;;;2BACIR,MAAM;EACT,UAAIU,IAAI,GAAGhC,MAAM,CAACgC,IAAP,CAAYV,IAAZ,CAAX;EACAU,MAAAA,IAAI,CAAC7B,OAAL,CAAa,UAAAa,GAAG,EAAI;EAClBO,QAAAA,KAAK,GAAGD,IAAI,CAACN,GAAD,CAAZ;EACAiB,QAAAA,cAAc,CAACX,IAAD,EAAON,GAAP,EAAYO,KAAZ,CAAd;EACD,OAHD;EAID;;;;;;EAGH,SAASU,cAAT,CAAwBX,IAAxB,EAA8BN,GAA9B,EAAmCO,KAAnC,EAA0C;EACxCQ,EAAAA,OAAO,CAACR,KAAD,CAAP;EACAvB,EAAAA,MAAM,CAACiB,cAAP,CAAsBK,IAAtB,EAA4BN,GAA5B,EAAiC;EAC/BE,IAAAA,GAD+B,iBACzB;EACJ,aAAOK,KAAP;EACD,KAH8B;EAI/BJ,IAAAA,GAJ+B,eAI3BC,QAJ2B,EAIjB;EACZ,UAAGA,QAAQ,IAAIG,KAAf,EAAsB;EACtBQ,MAAAA,OAAO,CAACX,QAAD,CAAP;EACAG,MAAAA,KAAK,GAAGH,QAAR;EACD;EAR8B,GAAjC;EAUD;;EACM,SAASW,OAAT,CAAiBT,IAAjB,EAAuB;EAC5B,MAAG,QAAOA,IAAP,MAAgB,QAAhB,IAA4BA,IAAI,KAAK,IAAxC,EAA8C;EAC5C,WAAO,IAAID,QAAJ,CAAaC,IAAb,CAAP;EACD;EACF;;EC3DM,SAASY,SAAT,CAAoBpB,EAApB,EAAwB;EAC7B,MAAMqB,IAAI,GAAGrB,EAAE,CAACsB,QAAhB;;EACA,MAAGD,IAAI,CAACb,IAAR,EAAc;EACZe,IAAAA,QAAQ,CAAA,CAAR;EACD,GAJ4B;EAM7B;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACD;;EAED,SAASA,QAAT,GAAmB;EACjB,MAAIf,IAAI,GAAG,KAAKc,QAAL,CAAcd,IAAzB;EACAA,EAAAA,IAAI,GAAGR,EAAE,CAACwB,KAAH,GAAW,OAAOhB,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,CAACiB,IAAL,CAAUzB,EAAV,CAA7B,GAA6CQ,IAA/D;EACAS,EAAAA,OAAO,CAACT,IAAD,CAAP;EACD;EAED;EACA;EACA;;EC7BA,IAAMkB,MAAM,+BAAZ;EACA,IAAMC,YAAY,iBAAUD,MAAV,gBAAuBA,MAAvB,MAAlB;EACA,IAAME,YAAY,GAAG,IAAIC,MAAJ,aAAgBF,YAAhB,EAArB;;EAEA,IAAMG,MAAM,GAAG,IAAID,MAAJ,gBAAmBF,YAAnB,YAAf;;EACA,IAAMI,SAAS,GAAG,2EAAlB;;EACA,IAAMC,aAAa,GAAG,YAAtB;;EACA,IAAMC,YAAY,GAAG,0BAArB;EACA,IAAIC,IAAJ;EACA,IAAIC,aAAJ;EACA,IAAIC,KAAK,GAAG,EAAZ;EACA,IAAMC,YAAY,GAAG,CAArB;EACA,IAAMC,SAAS,GAAG,CAAlB;;EAEA,SAASC,gBAAT,CAA0BC,OAA1B,EAAkCC,KAAlC,EAAwC;EACpC,SAAO;EACHC,IAAAA,GAAG,EAACF,OADD;EAEHG,IAAAA,IAAI,EAACN,YAFF;EAGHO,IAAAA,QAAQ,EAAC,EAHN;EAIHH,IAAAA,KAAK,EAALA,KAJG;EAKHI,IAAAA,MAAM,EAAC;EALJ,GAAP;EAOH;;EACD,SAASC,KAAT,CAAeN,OAAf,EAAwBC,KAAxB,EAA+B;EAC3B,MAAIM,OAAO,GAAGR,gBAAgB,CAACC,OAAD,EAASC,KAAT,CAA9B;;EACA,MAAG,CAACP,IAAJ,EAAS;EACLA,IAAAA,IAAI,GAAGa,OAAP;EACH;;EACDZ,EAAAA,aAAa,GAAGY,OAAhB;EACAX,EAAAA,KAAK,CAACY,IAAN,CAAWD,OAAX;EACH;;EACD,SAASE,GAAT,CAAaT,OAAb,EAAsB;EAClB,MAAIO,OAAO,GAAGX,KAAK,CAACc,GAAN,EAAd;EACAf,EAAAA,aAAa,GAAGC,KAAK,CAACA,KAAK,CAACe,MAAN,GAAa,CAAd,CAArB;;EACA,MAAGhB,aAAH,EAAiB;EACbY,IAAAA,OAAO,CAACF,MAAR,GAAiBV,aAAjB;EACAA,IAAAA,aAAa,CAACS,QAAd,CAAuBI,IAAvB,CAA4BD,OAA5B;EACH;EACJ;;EACD,SAASK,KAAT,CAAeC,IAAf,EAAqB;EACjBA,EAAAA,IAAI,GAAGA,IAAI,CAACC,OAAL,CAAa,KAAb,EAAmB,EAAnB,CAAP;;EACA,MAAGD,IAAH,EAAQ;EACJlB,IAAAA,aAAa,CAACS,QAAd,CAAuBI,IAAvB,CAA4B;EACxBL,MAAAA,IAAI,EAACL,SADmB;EAExBe,MAAAA,IAAI,EAAJA;EAFwB,KAA5B;EAIH;EACJ;;EACD,SAASE,SAAT,CAAmBC,IAAnB,EAAwB;EACpB,SAAMA,IAAN,EAAW;EACP,QAAIC,OAAO,GAAGD,IAAI,CAACE,OAAL,CAAa,GAAb,CAAd;;EACA,QAAGD,OAAO,IAAI,CAAd,EAAgB;EACZ,UAAME,aAAa,GAAGC,aAAa,EAAnC;;EACA,UAAGD,aAAH,EAAiB;EACbb,QAAAA,KAAK,CAACa,aAAa,CAACnB,OAAf,EAAuBmB,aAAa,CAAClB,KAArC,CAAL;EACA;EACH;;EACD,UAAMoB,WAAW,GAAGL,IAAI,CAACM,KAAL,CAAWhC,MAAX,CAApB;;EACA,UAAG+B,WAAH,EAAe;EACXE,QAAAA,OAAO,CAACF,WAAW,CAAC,CAAD,CAAX,CAAeV,MAAhB,CAAP;EACAF,QAAAA,GAAG,CAACY,WAAW,CAAC,CAAD,CAAZ,CAAH;EACA;EACH;EACJ;;EACD,QAAIR,IAAI,SAAR;;EACA,QAAGI,OAAO,IAAI,CAAd,EAAgB;EACZJ,MAAAA,IAAI,GAAGG,IAAI,CAACQ,SAAL,CAAe,CAAf,EAAiBP,OAAjB,CAAP;EACH;;EACD,QAAGJ,IAAH,EAAQ;EACJU,MAAAA,OAAO,CAACV,IAAI,CAACF,MAAN,CAAP;EACAC,MAAAA,KAAK,CAACC,IAAD,CAAL;EACH;EACJ;;EACD,WAASU,OAAT,CAAiBE,CAAjB,EAAmB;EACfT,IAAAA,IAAI,GAAGA,IAAI,CAACQ,SAAL,CAAeC,CAAf,CAAP;EACH;;EACD,WAASL,aAAT,GAAwB;EACpB,QAAMd,KAAK,GAAGU,IAAI,CAACM,KAAL,CAAWlC,YAAX,CAAd;;EACA,QAAGkB,KAAH,EAAS;EACL,UAAMgB,KAAK,GAAG;EACVtB,QAAAA,OAAO,EAACM,KAAK,CAAC,CAAD,CADH;EAEVL,QAAAA,KAAK,EAAC;EAFI,OAAd;EAIAsB,MAAAA,OAAO,CAACjB,KAAK,CAAC,CAAD,CAAL,CAASK,MAAV,CAAP;;EACA,UAAIe,IAAJ,EAASjB,IAAT;;EACA,aAAM,EAAEA,IAAG,GAAGO,IAAI,CAACM,KAAL,CAAW9B,aAAX,CAAR,MAAuCkC,IAAI,GAAGV,IAAI,CAACM,KAAL,CAAW/B,SAAX,CAA9C,CAAN,EAA2E;EACvEgC,QAAAA,OAAO,CAACG,IAAI,CAAC,CAAD,CAAJ,CAAQf,MAAT,CAAP;EACAW,QAAAA,KAAK,CAACrB,KAAN,CAAYO,IAAZ,CAAiB;EAACmB,UAAAA,IAAI,EAACD,IAAI,CAAC,CAAD,CAAV;EAAczD,UAAAA,KAAK,EAACyD,IAAI,CAAC,CAAD;EAAxB,SAAjB;EACH;;EACD,UAAGjB,IAAH,EAAO;EACHc,QAAAA,OAAO,CAACd,IAAG,CAAC,CAAD,CAAH,CAAOE,MAAR,CAAP;EACA,eAAOW,KAAP;EACH;EACJ;EACJ;EACJ;;EAGM,SAASM,kBAAT,CAA4BC,QAA5B,EAAqC;EAC1Cd,EAAAA,SAAS,CAACc,QAAD,CAAT;;EAEA,WAASC,GAAT,CAAaC,IAAb,EAAmB;EACjB,QAAIA,IAAI,CAAC5B,IAAL,IAAa,CAAjB,EAAoB;EAChB,aAAO6B,QAAQ,CAACD,IAAD,CAAf;EACH,KAFD,MAEO;EACH,UAAIlB,IAAI,GAAGkB,IAAI,CAAClB,IAAhB;;EACA,UAAG,CAACpB,YAAY,CAACwC,IAAb,CAAkBpB,IAAlB,CAAJ,EAA4B;EACxB,4BAAaqB,IAAI,CAACC,SAAL,CAAetB,IAAf,CAAb;EACH;;EACD,UAAIuB,SAAS,GAAG3C,YAAY,CAAC2C,SAAb,GAAyB,CAAzC;EACA,UAAIC,MAAM,GAAG,EAAb;EACA,UAAIf,KAAJ,EAAUgB,KAAV;;EAEA,aAAOhB,KAAK,GAAG7B,YAAY,CAAC8C,IAAb,CAAkB1B,IAAlB,CAAf,EAAwC;EACpCyB,QAAAA,KAAK,GAAGhB,KAAK,CAACgB,KAAd;;EACA,YAAGA,KAAK,GAAGF,SAAX,EAAqB;EACjBC,UAAAA,MAAM,CAAC7B,IAAP,CAAY0B,IAAI,CAACC,SAAL,CAAetB,IAAI,CAACxD,KAAL,CAAW+E,SAAX,EAAqBE,KAArB,CAAf,CAAZ;EACH;;EACDD,QAAAA,MAAM,CAAC7B,IAAP,cAAkBc,KAAK,CAAC,CAAD,CAAL,CAASkB,IAAT,EAAlB;EACAJ,QAAAA,SAAS,GAAGE,KAAK,GAAGhB,KAAK,CAAC,CAAD,CAAL,CAASX,MAA7B;EACH;;EACD,UAAGyB,SAAS,GAAGvB,IAAI,CAACF,MAApB,EAA2B;EACvB0B,QAAAA,MAAM,CAAC7B,IAAP,CAAY0B,IAAI,CAACC,SAAL,CAAetB,IAAI,CAACxD,KAAL,CAAW+E,SAAX,CAAf,CAAZ;EACH;;EACD,0BAAaC,MAAM,CAACI,IAAP,CAAY,GAAZ,CAAb;EACH;EACF;;EACD,WAASC,WAAT,CAAqBC,EAArB,EAAyB;EAAE;EACvB,QAAMvC,QAAQ,GAAGuC,EAAE,CAACvC,QAApB;;EACA,QAAIA,QAAJ,EAAc;EACZ,UAAMwC,GAAG,aAAMxC,QAAQ,CAACyC,GAAT,CAAa,UAAAC,CAAC;EAAA,eAAEhB,GAAG,CAACgB,CAAD,CAAL;EAAA,OAAd,EAAwBL,IAAxB,CAA6B,GAA7B,CAAN,CAAT;EACA,aAAOG,GAAP;EACD,KAHD,MAGO;EACL,aAAO,KAAP;EACD;EACJ;;EACD,WAASG,QAAT,CAAkB9C,KAAlB,EAAwB;EAAE;EACtB,QAAI+C,GAAG,GAAG,EAAV;;EACA,SAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAChD,KAAK,CAACU,MAAvB,EAA+BsC,CAAC,EAAhC,EAAmC;EAC/B,UAAIvB,IAAI,GAAGzB,KAAK,CAACgD,CAAD,CAAhB;;EACA,UAAGvB,IAAI,CAACC,IAAL,KAAc,OAAjB,EAAyB;EAAA;EACrB,cAAIuB,GAAG,GAAG,EAAV;EACAxB,UAAAA,IAAI,CAACzD,KAAL,CAAWkF,KAAX,CAAiB,GAAjB,EAAsBtG,OAAtB,CAA8B,UAAA2B,IAAI,EAAE;EAAA,8BACdA,IAAI,CAAC2E,KAAL,CAAW,GAAX,CADc;EAAA;EAAA,gBAC3BzF,GAD2B;EAAA,gBACvBO,KADuB;;EAEhCiF,YAAAA,GAAG,CAACxF,GAAD,CAAH,GAAWO,KAAX;EACH,WAHD;EAIAyD,UAAAA,IAAI,CAACzD,KAAL,GAAaiF,GAAb;EANqB;EAOxB;;EACDF,MAAAA,GAAG,cAAOtB,IAAI,CAACC,IAAZ,cAAoBO,IAAI,CAACC,SAAL,CAAeT,IAAI,CAACzD,KAApB,CAApB,MAAH;EACH;;EACD,sBAAW+E,GAAG,CAAC3F,KAAJ,CAAU,CAAV,EAAY,CAAC,CAAb,CAAX;EACH;;EACD,WAAS2E,QAAT,CAAkBW,EAAlB,EAAsB;EAClB,QAAIvC,QAAQ,GAAGsC,WAAW,CAACC,EAAD,CAA1B;EACA,QAAIS,IAAI,iBAAUT,EAAE,CAACzC,GAAb,eACJyC,EAAE,CAAC1C,KAAH,CAASU,MAAT,aAAmBoC,QAAQ,CAACJ,EAAE,CAAC1C,KAAJ,CAA3B,IAAwC,WADpC,SAGJG,QAAQ,cAAMA,QAAN,IAAiB,EAHrB,MAAR;EAKA,WAAOgD,IAAP;EACH;;EACD,MAAIA,IAAI,GAAGpB,QAAQ,CAACtC,IAAD,CAAnB;EACA,MAAI2D,MAAM,+BAAwBD,IAAxB,MAAV;EACA,MAAIE,QAAQ,GAAG,IAAIC,QAAJ,CAAaF,MAAb,CAAf;EACA,SAAOC,QAAP;EAED;;ECnKM,SAASE,SAAT,CAAoBC,GAApB,EAAyB;EAC9BA,EAAAA,GAAG,CAACjH,SAAJ,CAAckH,KAAd,GAAsB,UAASC,OAAT,EAAkB;EACtC,QAAMnG,EAAE,GAAG,IAAX;EACA,SAAKsB,QAAL,GAAgB6E,OAAhB,CAFsC;;EAItC/E,IAAAA,SAAS,CAACpB,EAAD,CAAT,CAJsC;;EAOtC,QAAIA,EAAE,CAACsB,QAAH,CAAY6D,EAAhB,EAAoB;EACnBnF,MAAAA,EAAE,CAACoG,MAAH,CAAUpG,EAAE,CAACsB,QAAH,CAAY6D,EAAtB;EACA;EACF,GAVD;;EAWAc,EAAAA,GAAG,CAACjH,SAAJ,CAAcoH,MAAd,GAAuB,UAASjB,EAAT,EAAa;EAElC,QAAMgB,OAAO,GAAG,KAAK7E,QAArB;EACA6D,IAAAA,EAAE,GAAGkB,QAAQ,CAACC,aAAT,CAAuBnB,EAAvB,CAAL,CAHkC;;EAMlC,QAAG,CAACgB,OAAO,CAACN,MAAZ,EAAoB;EAClB,UAAIxB,QAAQ,GAAG8B,OAAO,CAAC9B,QAAvB;;EACA,UAAG,CAACA,QAAD,IAAac,EAAhB,EAAoB;EAClBd,QAAAA,QAAQ,GAAGc,EAAE,CAACoB,SAAd;EACD;;EACD,UAAMV,MAAM,GAAGzB,kBAAkB,CAACC,QAAD,CAAjC;EACA8B,MAAAA,OAAO,CAACN,MAAR,GAAiBA,MAAjB;EACD;EACF,GAdD;EAeD;;EC7BD,SAASI,GAAT,CAAcE,OAAd,EAAuB;EACrB,OAAKD,KAAL,CAAWC,OAAX;EACD;;EACDH,SAAS,CAACC,GAAD,CAAT;;;;;;;;"}