{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\nlet methods = [\n    'push',\n    'pop',\n    'shift',\n    'unshift',\n    'reverse',\n    'sort',\n    'splice'\n];\nmethods.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        const result = oldArrayProtoMethods[method].apply(this, args);\n        const ob = this.__ob__;\n        let inserted;\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                inserted = args;\n                break;\n            case 'splice':\n                inserted = args.slice(2)\n            default:\n                break;\n        }\n        if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\n        return result\n    }\n})","import {arrayMethods} from './array';\n\nfunction proxy(vm,source,key){\n  Object.defineProperty(vm,key,{\n      get(){\n          return vm[source][key];\n      },\n      set(newValue){\n          vm[source][key] = newValue;\n      }\n  });\n}\n\nclass Observer {\n  constructor(data) {\n    Object.defineProperty(value,'__ob__',{\n      enumerable:false,\n      configurable:false,\n      value:this\n    });\n    for(let key in data){ // 将_data上的属性全部代理给vm实例\n      proxy(vm,'_data',key)\n    }\n    if(Array.isArray(data)) {\n      value.__proto__ = arrayMethods\n      this.observeArray(data)\n    }else {\n      this.walk(data)\n    }\n  }\n  observeArray(array) {\n    array.forEach(item => {\n      observe(item)\n    })\n  }\n  walk(data) {\n    let keys = Object.keys(data)\n    keys.forEach(key => {\n      value = data[key]\n      defineReactive(data, key, value)\n    })\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value)\n  Object.defineProperty(data, key, {\n    get() {\n      return value\n    },\n    set(newValue) {\n      if(newValue == value) return;\n      observe(newValue);\n      value = newValue\n    }\n  })\n}\nexport function observe(data) {\n  if(typeof data === 'object' && data !== null) {\n    return new Observer(data)\n  }\n}","import {observe} from './observer/index.js'\n\nexport function initState (vm) {\n  const opts = vm.$options\n  if(opts.data) {\n    initData(vm)\n  }\n  // if(opts.props) {\n  //   initProps(vm)\n  // }\n  // if(opts.methods) {\n  //   initMethod(vm)\n  // }\n  // if(opts.computed) {\n  //   initComputed(vm)\n  // }\n  // if(opts.watch) {\n  //   initWatch(vm)\n  // }\n}\n\nfunction initData(){\n  let data = this.$options.data\n  data = vm._data = typeof data === 'function' ? data.call(vm) : data\n  observe(data)\n}\n// function initProps(){}\n// function initMethod(){}\n// function initComputed(){}\n// function initWatch(){}","import {initState} from './state'\nexport function initMixin (Vue) {\n  Vue.prototype._init = function(options) {\n    const vm = this\n    this.$options = options\n    initState(vm)\n  }\n}","import {initMixin} from './init.js'\nfunction Vue (options) {\n  this._init(options)\n}\ninitMixin(Vue)\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","result","apply","ob","__ob__","inserted","slice","observeArray","proxy","vm","source","key","defineProperty","get","set","newValue","Observer","data","value","enumerable","configurable","isArray","__proto__","walk","array","item","observe","keys","defineReactive","initState","opts","$options","initData","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}